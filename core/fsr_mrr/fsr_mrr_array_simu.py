# V range: 0V-1.2V
# weights range:0.06635011554313516-0.7732044672994702
# Output: [i][j]: weight at i-th MRR j-th FSR parallelism, i in range(4), j in range(8)

import numpy as np
import torch

WEIGHTS_DATA_VERSION = '0731'
# WEIGHTS_DATA_VERSION = '0823'
# WEIGHTS_DATA_VERSION = 'LAB_DATA'

#####
    ### 0731 weights_data
#####
if WEIGHTS_DATA_VERSION == '0731':
    weights_data = []
    weights_data.append([[0.06635011554313516,
        0.06430304332415636,
        0.07991098902370337,
        0.1132938144591259,
        0.18370374989488744,
        0.36850848671740777,
        0.515205440862139,
        0.6217937231801076,
        0.7000194899960028,
        0.7537989932863055,
        0.7919436552831304,
        0.8193217580647328,
        0.834970055413045],
      [0.05611841285430005,
        0.05605743749238455,
        0.06284077040864103,
        0.09281107203219856,
        0.1497940427113462,
        0.30877800507209574,
        0.4362303756311697,
        0.5344443550559937,
        0.6101618129411536,
        0.6693969629270287,
        0.7016252797951879,
        0.7323710364740955,
        0.7481129334710305],
      [0.05761057695235265,
        0.058916039723112774,
        0.06790907505380055,
        0.09871314730000755,
        0.1596475373838656,
        0.33481239851972566,
        0.4683037859538679,
        0.5818670228744108,
        0.6646443481406773,
        0.723675899060274,
        0.7698735296011557,
        0.7968221456274237,
        0.8154295232089149],
      [0.04950443033498306,
        0.051772094964488244,
        0.05724251319850846,
        0.0902460829044687,
        0.1476525974118347,
        0.3177257383660576,
        0.4504289791892508,
        0.5630502763636742,
        0.6439026792727586,
        0.7030001677396468,
        0.7503960444828823,
        0.7793889988786259,
        0.8011313844298137],
      [0.05231798517249607,
        0.049322368875595594,
        0.05587529974979146,
        0.0825903971917909,
        0.14106093398241856,
        0.30637943193165956,
        0.4480134704119684,
        0.5669604244564056,
        0.665251699417159,
        0.7317826484875581,
        0.7811766967651581,
        0.8149477332610524,
        0.8386362680524805],
      [0.053497473538449206,
        0.05395921413774107,
        0.06360760178549194,
        0.09553099548883175,
        0.16263223304406346,
        0.3407908062801851,
        0.48998616457822747,
        0.6208373096331239,
        0.7145057414737942,
        0.7840316890309735,
        0.8405223430971319,
        0.8772146884088997,
        0.8999082391481588],
      [0.0490165063389582,
        0.05055169995749796,
        0.06385510452113648,
        0.09557775783827925,
        0.16514646013218415,
        0.3492635639932869,
        0.5068380280510767,
        0.6429105734343015,
        0.7559571427478372,
        0.8311528358078051,
        0.8889523772736725,
        0.9293632124981902,
        0.9513603101465817],
      [0.04336808275938266,
        0.04583278397665362,
        0.05533971153666042,
        0.08279259502976226,
        0.14269104815733127,
        0.3279822929405977,
        0.48776362216072283,
        0.6280744609014363,
        0.7444164920194871,
        0.8268022431050653,
        0.8842251199492133,
        0.9301629864064334,
        0.9576249830982411]])
          
    weights_data.append([[0.05082875399340792,
        0.05329476903676784,
        0.08693269285009526,
        0.18067577811725344,
        0.33516013840381265,
        0.4913249311016246,
        0.6047279840108939,
        0.6704814069500299,
        0.7025145002943322,
        0.7337438854570388,
        0.7469093201182082,
        0.7641672331603372,
        0.7732044672994702],
      [0.052877674216882956,
        0.052247113511130684,
        0.0694081339951734,
        0.14988378177547015,
        0.29857091960784754,
        0.46899178818204856,
        0.6004594394638874,
        0.6719364725461123,
        0.718527725251435,
        0.7542681671330794,
        0.7702221574563916,
        0.7797951988091649,
        0.7906425817261593],
      [0.05318680290822966,
        0.05821720791613105,
        0.09243914754894399,
        0.19110650051994857,
        0.35092753310273617,
        0.5225050092554435,
        0.6559583658820666,
        0.7355787705303133,
        0.7798735383499206,
        0.8118342749345905,
        0.8252937088041848,
        0.8359472552160859,
        0.8426746932026191],
      [0.04269623509821879,
        0.047227736949987616,
        0.08144703881706374,
        0.1795876012433535,
        0.3341103127483463,
        0.4997163714980309,
        0.6305754124692419,
        0.7131203564318025,
        0.7619403456637786,
        0.7926443726868744,
        0.8057314246008025,
        0.8228430827662787,
        0.8288837431512773],
      [0.04508575307497476,
        0.04652767850702222,
        0.07453788882570844,
        0.15895393991503992,
        0.31749412018465106,
        0.49027125874156663,
        0.6262375439680444,
        0.716549832324404,
        0.7675979960471171,
        0.8034295321217244,
        0.8338606835570512,
        0.8505453870214819,
        0.8530032356117664],
      [0.046166365013331954,
        0.0480553466020735,
        0.0767393359867158,
        0.16512374776758174,
        0.32243997567794624,
        0.5066035680941082,
        0.6523568724998439,
        0.7467494696815792,
        0.7976458255616796,
        0.8355887852647519,
        0.8508589418362987,
        0.8647394622349593,
        0.8726062530022344],
      [0.04157677678341085,
        0.04477701149771415,
        0.07636004200899373,
        0.17295101355322406,
        0.342305659946204,
        0.5501215271583186,
        0.7103273658732049,
        0.8201853654915205,
        0.8796881987290062,
        0.9236314227853489,
        0.9529259526642062,
        0.9689457494572363,
        0.9785586662788769],
      [0.03719676121983025,
        0.03516723503130404,
        0.05734551309543111,
        0.14245254487550263,
        0.30462416333906345,
        0.5015754949502716,
        0.6703028570985696,
        0.7937015139636362,
        0.8707599959237006,
        0.9150845206133104,
        0.935734902885174,
        0.9397631127333137,
        0.950340807818434]])
          
    weights_data.append([[0.04931286492385732,
        0.04953100669816726,
        0.051976183659137996,
        0.05698121304027827,
        0.07932973778651785,
        0.12154014822079658,
        0.19684657390488272,
        0.32843846300828033,
        0.584998199504441,
        0.6553439533984593,
        0.7447244093883788,
        0.7786558725449731,
        0.7952060806936101],
      [0.0431290586470904,
        0.04712020608165282,
        0.049062361763656435,
        0.05042843883365111,
        0.07240137833697148,
        0.10297631884465064,
        0.1787920145615624,
        0.3064886589246431,
        0.5964595046923206,
        0.6742703623258162,
        0.776681782792593,
        0.816589951668415,
        0.833217279469477],
      [0.05373655780404975,
        0.05256629612372701,
        0.05371825486860062,
        0.060028349016237756,
        0.07663152262610885,
        0.10810087678145126,
        0.1871175388171829,
        0.31936341922577627,
        0.6199176732894187,
        0.7080803971434069,
        0.8265840647516586,
        0.8695201629838087,
        0.8941321018065048],
      [0.04059384175908627,
        0.04364726856871063,
        0.046127836514698005,
        0.05519282743241329,
        0.07626567627751296,
        0.11551310066292524,
        0.1888810496097948,
        0.3185385083847109,
        0.5889006982068185,
        0.6723211879266118,
        0.7904158027730518,
        0.8210691077342562,
        0.8527305272465308],
      [0.03778573186138144,
        0.0382973370251073,
        0.04370930374422776,
        0.050104860329632,
        0.07518473485427028,
        0.10557917015236105,
        0.17997450485553027,
        0.3014697591040314,
        0.5646494963032754,
        0.6448360758462472,
        0.7565005364805181,
        0.790935753853623,
        0.8145451433665318],
      [0.03888942729571021,
        0.03844169396592821,
        0.04031579186400816,
        0.046900801406207906,
        0.06287318417085024,
        0.09341583664362614,
        0.16059150883730094,
        0.2855566602156474,
        0.5660190474935201,
        0.6529273260363868,
        0.772721693391435,
        0.8234568981200674,
        0.8521138926970159],
      [0.03436871468360154,
        0.034871944718398336,
        0.035803963202027576,
        0.03904921326697467,
        0.05397506973819266,
        0.08189671828853798,
        0.14760056528334944,
        0.2706073731162708,
        0.55199587791079,
        0.6377184733566403,
        0.7872643024829611,
        0.8343181691432431,
        0.8599407563434205],
      [0.03219638881652018,
        0.03219638881652018,
        0.033868495323290095,
        0.03934352310981055,
        0.058378290672406845,
        0.09069908027993781,
        0.16197379629676223,
        0.29786025697794305,
        0.5985842009304203,
        0.7010483617783909,
        0.8347081403429283,
        0.8915102354457458,
        0.9182411543681047]])
        
    weights_data.append([[0.03331902362529174,
        0.03407884463106226,
        0.04293634455541058,
        0.08544887522823154,
        0.18215742495734677,
        0.3242990279218961,
        0.46493970934734735,
        0.5772937934108527,
        0.659142659512987,
        0.7112292017972449,
        0.7417367913595556,
        0.7640523145387601,
        0.7811695947021463],
      [0.03551090940239438,
        0.03551090940239438,
        0.04474631066750585,
        0.0922189697933475,
        0.1865147177785518,
        0.34151382319608103,
        0.48660216792607897,
        0.6138792902402843,
        0.703565466009404,
        0.7609399720157233,
        0.7886396413601555,
        0.8084255121575198,
        0.82095551323611],
      [0.03716786346670023,
        0.0388901441106989,
        0.04176876613590343,
        0.08880854499981378,
        0.1903297665418814,
        0.35149813680309605,
        0.5275867066738824,
        0.6686790540914198,
        0.7747777746933016,
        0.8447607783163616,
        0.8843357957708063,
        0.9153086212654943,
        0.932514070031313],
      [0.03068557502295826,
        0.0290917829038792,
        0.038358024777453405,
        0.08296877141657574,
        0.18293031813880434,
        0.3316519048192603,
        0.48649712090996905,
        0.6315935622370495,
        0.7290105596113894,
        0.7910483377621127,
        0.8351414952410652,
        0.8638544426514482,
        0.8761550939025219],
      [0.029205405409689824,
        0.02636648908033067,
        0.03395580331566838,
        0.07412261078351802,
        0.1620189959749929,
        0.31277469914327244,
        0.47204121601855004,
        0.6100350562276979,
        0.7111667897157037,
        0.7773282365230002,
        0.8231689844904393,
        0.8501052037601288,
        0.8808231260103583],
      [0.025953968334801604,
        0.02869865046044602,
        0.03786080494360696,
        0.08166903150837779,
        0.17174365933373753,
        0.31705906573935216,
        0.4719740473830532,
        0.6127157290538033,
        0.7159903885559141,
        0.7827050383311612,
        0.8343404902525003,
        0.8571893585397432,
        0.8772959576032037],
      [0.028401681572866815,
        0.025845378404480118,
        0.029830525670276165,
        0.0662503111967216,
        0.15712582158232427,
        0.3142953798576648,
        0.490696689875071,
        0.6596878304873934,
        0.774646453309499,
        0.8635640290514067,
        0.9205483039070529,
        0.9519895825331983,
        0.9824468206481016],
      [0.02318045419798043,
        0.020241956121933597,
        0.028168876006392837,
        0.07027088794827784,
        0.16057847450688847,
        0.3162575272977633,
        0.4990789283563671,
        0.6625106106440819,
        0.7755245137476562,
        0.8547483514606099,
        0.9084871905699978,
        0.9367412531727802,
        0.971643329747696]])

    #####
        # crosstalks_data
    #####

    crosstalks_data = []
    crosstalks_data.append([[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0017487939935600244,
    -0.0008846567572988809,
    -0.002597732089529965,
    -0.0008846567572988809,
    -0.002597732089529965,
    -0.0009287130102110727,
    -0.001700597182138032,
    -0.0017487939935600244,
    -0.004393325630589251,
    -0.007883313256945496,
    -0.02110070335561846,
    -0.03786510137383962],
    [0.0,
    0.002648146209432947,
    0.0001041134076641137,
    0.0009886364049863164,
    0.005191782620192258,
    0.004329000280730459,
    0.004329000280730459,
    0.0009886364049863164,
    0.006071871508535283,
    0.005191782620192258,
    0.005191782620192258,
    0.005087669157686228,
    0.0060219048508593775],
    [0.0,
    0.00012404865486227712,
    0.003206377351878696,
    0.0024629417191930347,
    0.0032609946027591305,
    0.0024096295382244615,
    0.005451580752481061,
    0.005547366617200962,
    0.0016237778426846025,
    0.004022629368512665,
    0.005393381197555287,
    0.007887914172606647,
    0.009478553868258584]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0021349326095207455,
    0.0013393146217534763,
    -0.0006652831373416893,
    0.0007056658085904527,
    0.0007584213936499828,
    -0.0006096652790290244,
    -0.0019963091379765277,
    -0.0006096652790290244,
    -0.005397343737043175,
    -0.009660351355275806,
    -0.019119916612890656,
    -0.03628803664303336],
    [0.0,
    -0.0034247123881364708,
    -0.0006804917600170893,
    -0.0020420802386983197,
    -0.004084204802833023,
    -0.002755051405696783,
    -0.0034918523095113646,
    -0.0020420802386983197,
    -0.005434342601039158,
    -0.0033927216789934114,
    -0.0016275735481486656,
    -0.0035209683956806057,
    -0.0007114954742036064],
    [0.0,
    0.0006768946518060717,
    -0.0006643255089562039,
    -0.002736860485485368,
    -0.0034273111702422393,
    0.00071763824606242,
    -0.0007035262153925054,
    0.0014081107260683068,
    0.0,
    0.002111647053718288,
    0.0014081107260683068,
    0.004147474073460271,
    0.0013710164477866507]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0005587655423095056,
    -0.001824985550676242,
    0.0006007876416168206,
    -0.004269164408213844,
    -0.002396314269394628,
    -0.001824985550676242,
    -0.0036054043902113073,
    -0.0036500311886598358,
    -0.009063903929963042,
    -0.010816485052139092,
    -0.021106026592511852,
    -0.04110234896160629],
    [0.0,
    -0.0005573223800845808,
    0.0023665370527267,
    0.0012009412287895052,
    0.002959146949069527,
    0.002387007071988946,
    0.0012009412287895052,
    0.0012224181457037575,
    0.0023665370527267,
    0.002344547772676904,
    0.002959146949069527,
    0.0018012198835284446,
    0.00471730071994704],
    [0.0,
    -0.001213318962611995,
    -0.0006979091601489601,
    0.000620600605857953,
    0.0,
    0.000620600605857953,
    0.001803135288944574,
    0.0030233156847779413,
    0.0005631773167512066,
    0.0005631773167512066,
    0.0017181888384846106,
    0.0036331088376847787,
    0.005409046080211012]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0,
    0.0010508178561146886,
    0.0,
    0.00042862039832571724,
    0.0005536874688280569,
    0.0,
    -4.104931065892353e-05,
    -0.001618800027163296,
    -0.0027062359867881247,
    -0.007050722256378636,
    -0.01674391822752353,
    -0.03465991990289861],
    [0.0,
    0.0004948903379932632,
    0.0,
    -0.001028774501540479,
    -0.0005279503850564235,
    0.0004740222493146845,
    0.001542961827975059,
    0.0010351095937506036,
    0.0025589714933360527,
    0.001015538981995065,
    0.004102353189123706,
    0.004102353189123706,
    0.0035628479946238287],
    [0.0,
    0.003290498382116515,
    9.709136971880472e-05,
    0.0006239381043774347,
    0.002178331886495806,
    0.001707724238868235,
    0.003290498382116515,
    0.004278623931298905,
    0.0048520318000660236,
    0.00475061052411575,
    0.004902506651013019,
    0.005302803865330132,
    0.006438449129984657]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0005703796561486382,
    -0.0021103115028907604,
    0.001045774669880678,
    -1.8599546751138507e-05,
    -0.0005703796561486382,
    -5.7163000328278035e-05,
    -0.004214290180610605,
    -0.003708140012601953,
    -0.005814337284747242,
    -0.010000894701474562,
    -0.020511592363466783,
    -0.03526849966417778],
    [0.0,
    0.001007094818183854,
    0.0005107571848820269,
    -0.00011452660454430025,
    0.0004476566060021489,
    0.002979909271021104,
    0.0020001469568460203,
    0.0034696212269954424,
    0.003989058687517644,
    0.002517504294702294,
    0.003947066623428856,
    0.005518862812312814,
    0.00553825990258601],
    [0.0,
    0.0009527514796514001,
    0.0014045422333607768,
    0.001009052871651154,
    -6.0836335235674166e-05,
    0.0014347668101520085,
    0.0014347668101520085,
    0.002923261667329601,
    0.0029720820575020283,
    0.0034842973444722744,
    0.0024688760247096007,
    0.005464057396408907,
    0.004457902428833385]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0029934621195616753,
    0.0009932476011582925,
    0.0029934621195616753,
    0.002006416605258965,
    0.0010253071733107647,
    -0.0004622759576790522,
    -0.0004954076314843681,
    -0.0004622759576790522,
    -0.003437480922997241,
    -0.008409981264140658,
    -0.019307061788587546,
    -0.03576255608696656],
    [0.0,
    0.0038474154955626116,
    0.0028861661691421403,
    0.0024043525202990454,
    0.0009804844775043176,
    0.002903572177447522,
    0.003372663150604735,
    0.0019298310023707008,
    0.0028861661691421403,
    0.0038308255293811877,
    0.0038652521666002818,
    0.00233553013675359,
    0.004345949476872023],
    [0.0,
    0.0009573767704626895,
    -0.002409598433643915,
    0.00046369373729193697,
    0.00046369373729193697,
    -0.0005024365139402673,
    0.0014358320885237141,
    0.0014358320885237141,
    0.0019001822599407775,
    0.002393174487410679,
    0.0019001822599407775,
    0.004713640998275981,
    0.006209167471681411]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0009811382967781293,
    0.0014555624844484402,
    0.0009641974561905783,
    -0.0005243502686495607,
    0.00049615349394206,
    0.0,
    -0.003470073139961144,
    -0.002464606915628609,
    -0.0068809990927734405,
    -0.009363064101388333,
    -0.019754972840456696,
    -0.03393908604023585],
    [0.0,
    5.670188255898351e-05,
    0.0005461396117175041,
    -0.0004075883712564357,
    5.670188255898351e-05,
    -0.0013742530403212383,
    -0.0004075883712564357,
    -0.0008842854714631795,
    7.556303553601929e-05,
    -0.0037452006805322666,
    -0.0013742530403212383,
    -0.0013546144866555601,
    0.0005461396117175041],
    [0.0,
    0.0010805625769116263,
    -0.0004341157642531769,
    -0.0005001793086724486,
    -0.0009484486573863062,
    -0.0004341157642531769,
    -0.0004341157642531769,
    -0.001978084177886509,
    0.0005954223657103283,
    0.001604635739190053,
    0.0011097641016538824,
    0.0011097641016538824,
    0.004694186356622901]],
    [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.004495476638923031,
    0.001256683437882107,
    0.0017340393678145424,
    0.002853244335882278,
    8.389447803774236e-05,
    -0.0003627636664419731,
    0.00016022748701713385,
    -0.0009023999693835716,
    -0.003052498628908294,
    -0.005760994766634647,
    -0.014385832565219234,
    -0.024867873742425183],
    [0.0,
    0.0022186266799794456,
    0.0011503771910015108,
    0.003363035752972348,
    0.0005697982592726449,
    0.0034202633579978638,
    0.0016499003778302664,
    0.001119186727830821,
    0.0022186266799794456,
    0.0017101601755738112,
    -0.00013494493184089407,
    0.001053189839801759,
    0.0022799653515821992],
    [0.0,
    -0.0005492869807607742,
    0.001099978512974522,
    0.0016625741320035678,
    0.0006123609447797294,
    0.002308972688620032,
    0.003487307272759796,
    0.002270300517711276,
    0.004675064897261126,
    0.002270300517711276,
    0.004595433466833998,
    0.004637914196738289,
    0.00583620654846333]]])

    crosstalks_data.append([[[0.0,
    0.004532838804895592,
    0.008185113683663564,
    0.0036630604826421442,
    0.0027039008893110505,
    0.004598194548073947,
    0.0036630604826421442,
    0.00640205186621208,
    0.007273286781462662,
    0.01281268037961765,
    0.014618571529726204,
    0.018288896382222405,
    0.021885227721941347],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.002330039764156952,
    0.002373771568832006,
    0.0007512633806998487,
    -0.0007763729636259889,
    0.0006782653343240033,
    -0.0008998508708178143,
    0.0008319810969475358,
    0.0015966948782987073,
    -0.008757088771307334,
    -0.02681683558935466,
    -0.033184777671547656,
    -0.0007353616065038648],
    [0.0,
    -0.002184738299981573,
    0.0,
    -0.002184738299981573,
    -0.0006959593170861658,
    -0.0014229675949237117,
    0.003581064708458155,
    0.003581064708458155,
    0.0036275202674076537,
    0.007265567866626736,
    0.006591811399133347,
    0.010810776727811347,
    0.015317389316216727]],
    [[0.0,
    0.0006827511737352299,
    -0.0007266027836259348,
    -0.0007266027836259348,
    0.0020993471426727847,
    0.005598329630393313,
    0.003499026155106333,
    0.002074898460555051,
    0.0041497356144417075,
    0.007674255304469212,
    0.01038364799527499,
    0.013954143704102563,
    0.017480829829313226],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0019611582197995303,
    -2.7673338403796932e-05,
    0.0006350755917106515,
    -0.0013269030518631153,
    -0.003176448603516936,
    -0.0032352923287981283,
    -0.004466796003400261,
    -0.005778058297769048,
    -0.009596274148508943,
    -0.02730115860156226,
    -0.03368932581826266,
    -0.007656712767883739],
    [0.0,
    0.0006443942337028968,
    0.002512542782610032,
    0.0025471021052501167,
    0.003141331405424705,
    0.003141331405424705,
    0.006446134763863007,
    0.005801723180848137,
    0.0071004823866112204,
    0.007735539453216485,
    0.011603067961316417,
    0.011495253413107615,
    0.010967253635649911]],
    [[0.0,
    0.0,
    0.0011978027231204502,
    -0.0011916965960500417,
    0.002384172100710756,
    -3.564419339414232e-05,
    0.005373828747016647,
    0.0035931732645080247,
    0.003559532809213027,
    0.0064927200801605175,
    0.00718631141147532,
    0.010702642042829037,
    0.017952143061147223],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0,
    0.001105555866224961,
    -0.001640760895486315,
    -0.0005526432430998582,
    0.0,
    -0.0010814793395814981,
    -0.0027596330191990703,
    -0.004964031669213026,
    -0.009845328559643075,
    -0.03170838044328344,
    -0.03718179425527253,
    -0.00789734239081686],
    [0.0,
    -0.0034738296323415657,
    -0.0005690920825468584,
    -0.0011806840712042105,
    0.0005523149103111302,
    -0.001129542700912388,
    0.0005034082944040258,
    0.002747078182359919,
    0.0021872818397455154,
    0.006704601288421652,
    0.004955608523664307,
    0.006704601288421652,
    0.01108558815315537]],
    [[0.0,
    0.0020664766298314347,
    0.005714700735309525,
    0.004654558806397542,
    0.004124582908002883,
    0.004654558806397542,
    0.00779174654250038,
    0.00779174654250038,
    0.007805827967471132,
    0.00883750232540969,
    0.010398874485155168,
    0.012983942475129864,
    0.02132806063853676],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0005034955430693044,
    -0.0009664105940374035,
    0.0004913405403450047,
    -0.0009664105940374035,
    0.0,
    0.0014567170757641065,
    0.0004913405403450047,
    -0.0014403676053651518,
    -0.007668706434690968,
    -0.027836432781627545,
    -0.03165742060717426,
    -0.001926049577877599],
    [0.0,
    0.0020464751248887754,
    0.0005416153451856254,
    0.0020464751248887754,
    0.003575087376762768,
    0.004029669866963886,
    0.003575087376762768,
    0.0035511712686281706,
    0.004562325976211246,
    0.006025142557789753,
    0.01054153443732547,
    0.014599874737163222,
    0.014599874737163222]],
    [[0.0,
    -0.0009953212703877959,
    0.0013851088991327434,
    0.0032929482002777843,
    0.0023168084938495273,
    0.0023564406880857564,
    0.0037549872399316245,
    0.006103624587927986,
    0.002822572963712827,
    0.0042338497612412415,
    0.007032829183152352,
    0.012223722778868656,
    0.015046531555236747],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0013918776458083787,
    0.0023333536482525036,
    0.0028367513007024267,
    0.0009225616036895312,
    0.002366996596599724,
    0.001852394016584137,
    0.0009574553260542004,
    0.00042189394839731165,
    -0.007523762688955667,
    -0.02448155920280085,
    -0.030623370886731012,
    -0.00234450379726317],
    [0.0,
    -0.00044607663902534317,
    0.0009174048018544892,
    0.0013866482517567863,
    -0.0004957858349128111,
    0.00047802711949896173,
    0.002304282858628829,
    0.0032075297914440394,
    0.003227623984341399,
    0.00324966794115911,
    0.006932265142659957,
    0.010640104511327717,
    0.01103986942206139]],
    [[0.0,
    0.00043608697999486523,
    0.0013520482506490308,
    0.0017884772670489421,
    0.0008978572023009765,
    0.0036020806579777423,
    0.0049642683094548445,
    0.007197771231889798,
    0.004923853551141617,
    0.00811211375453709,
    0.00946409691197464,
    0.014871949202344234,
    0.01983450794214095],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0004377811681640295,
    0.0008758070860437964,
    0.0008758070860437964,
    0.0004430646677454006,
    0.0018058001196403356,
    -0.000471521739243308,
    -0.0013465293076675919,
    -0.003166527673671718,
    -0.008963414823357763,
    -0.026472062645728683,
    -0.028319465948553772,
    -0.004549218297681512],
    [0.0,
    -0.0009506692767878994,
    0.0009131879711844447,
    0.0009131879711844447,
    0.00047314934402401324,
    0.0026815137405709275,
    0.005831813317881261,
    0.0053794730162941146,
    0.0053794730162941146,
    0.004474479835566245,
    0.007961956093580885,
    0.009835558708195476,
    0.0097897296101161]],
    [[0.0,
    -0.001918728954103735,
    0.0004773660870153046,
    0.0009078192543460414,
    0.0009199553685520709,
    0.002378744133716769,
    0.0019096183638378991,
    0.005220509906876621,
    0.004272830243962543,
    0.007161203413026812,
    0.010003921927713447,
    0.014789642896756806,
    0.01861891347918645],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0017798320200666101,
    0.001334950360846257,
    0.0008957827472705696,
    0.001317119084374041,
    0.0004448796189453971,
    0.00040869490243591183,
    0.00040869490243591183,
    -0.0026699614230792507,
    -0.006698579793684378,
    -0.021848384384510904,
    -0.027239000568500787,
    -0.006675101219484728],
    [0.0,
    0.000942843131972966,
    0.0,
    0.002833142212484152,
    0.000942843131972966,
    0.00037655565236022204,
    0.0,
    0.0014407004086249321,
    0.0033613821334074305,
    0.0028560183301738797,
    0.00382588627460324,
    0.006730016110922551,
    0.005762539947120008]],
    [[0.0,
    -0.0009130831859319455,
    0.00048532370360376137,
    0.00048532370360376137,
    0.00048532370360376137,
    0.0009607275540133575,
    0.00422290707336892,
    0.0042101817009535525,
    0.004641828300227115,
    0.0055955350798128495,
    0.00795118313055971,
    0.009325919423795001,
    0.01400942984477458],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.000549551544152909,
    0.0021988750733252065,
    0.0016493178442944477,
    0.000574893809368298,
    5.2468527290960854e-05,
    0.001594124385136602,
    0.0027306584314698255,
    -0.0037175023099068026,
    -0.0063367175462361,
    -0.02122407173547477,
    -0.025144625525973546,
    -0.007934650091042793],
    [0.0,
    0.0018519392937363412,
    0.0029357045667363253,
    0.004030645892623676,
    0.002253916655528671,
    0.004492568046518316,
    0.004492568046518316,
    0.00503242497803438,
    0.00672681075874465,
    0.00672681075874465,
    0.007810263506244402,
    0.010927611793653765,
    0.011059625718521968]]])
      
    crosstalks_data.append([[[0.0,
    -6.843586446114713e-05,
    0.0,
    -0.0028672628316581267,
    -0.002938242997535548,
    -0.000979205576168582,
    -0.0019116999715574068,
    0.0009555663471626785,
    0.0028011654462505586,
    0.0038228027457731656,
    0.004756861822483277,
    0.009557197468565204,
    0.008601622621769042],
    [0.0,
    0.0016830639093464023,
    0.0017615819717005585,
    0.002584001850373434,
    -0.001709873161683341,
    -0.0008206527801245811,
    -0.001709873161683341,
    -0.0008206527801245811,
    0.003457150247552221,
    0.002584001850373434,
    0.0008737283277492347,
    0.001720506395586019,
    0.004343761526833287],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.001490029991595962,
    0.001556537349249841,
    -0.003014214815576177,
    0.0007952503920011372,
    -0.002234327833464271,
    0.002287270188559551,
    -0.0022877018439309144,
    0.0037984800306357577,
    0.004618273465963135,
    0.0030804024583953385,
    -0.0030663134631489924,
    -0.011445367164376902]],
    [[0.0,
    -0.0007411499818027745,
    0.0,
    -0.0029689361820141313,
    -0.001448166203181618,
    -0.0029403633976494634,
    0.0007500947832317847,
    2.590988567029162e-05,
    0.0,
    0.00219884217819135,
    0.0007238831231548906,
    0.002948335383227217,
    0.002948335383227217],
    [0.0,
    0.0034448724783351717,
    9.575432804102835e-05,
    0.0034448724783351717,
    0.002100849999258733,
    0.002100849999258733,
    0.0027691010503710645,
    0.0007640034070663868,
    7.184571396321587e-05,
    -0.004599907912227794,
    -0.003246250427189658,
    -0.0026450042362273496,
    -0.0039144948787984],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0012825725564380372,
    -3.440142895794196e-05,
    -7.263728816254283e-05,
    0.002025112095784376,
    0.0005852500410941028,
    0.0006518270270315027,
    0.002678059132473952,
    0.0,
    0.007366457100174223,
    0.006012644600757122,
    0.0013147291981807988,
    -0.0074111687550155875]],
    [[0.0,
    0.0018816023611469695,
    0.0006393211173387758,
    -0.0012609683990013748,
    0.0,
    -0.0006330446239596194,
    1.8291894466976322e-05,
    0.001847035887683035,
    0.0025026326315614467,
    0.004401814231647039,
    0.006910059525166004,
    0.0025026326315614467,
    0.004401814231647039],
    [0.0,
    0.0017244522187033692,
    0.0005747352678465295,
    -0.0017808050410165963,
    0.0011744988134139364,
    -0.0011872997932682386,
    -0.002348742860540272,
    -0.0011872997932682386,
    0.0023014457591926385,
    0.001137723140212099,
    0.0035232188919950558,
    0.004098693498804845,
    0.0035232188919950558],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0005783447101009725,
    -0.003522279882677906,
    -0.003522279882677906,
    -0.002935420554170204,
    -0.0024245655959708595,
    -0.0023666629752944965,
    -0.0017611211184688572,
    -0.0029625709580468687,
    0.0017610882114044782,
    -0.0012286345651335157,
    -0.004128753894070025,
    -0.014664176134885878]],
    [[0.0,
    -0.0016503464160599751,
    -0.0005396532376410051,
    0.0005604380790173169,
    -0.0011057984750792102,
    -0.0022055874956474764,
    -0.0021746988296508785,
    -0.0011688934697754727,
    -0.0005396532376410051,
    -0.0006298584498760085,
    0.0005455588002955675,
    0.0032703014572413452,
    0.005392915268174793],
    [0.0,
    -0.001066585115965711,
    -0.001066585115965711,
    0.001036085247189393,
    -0.00052700717973065,
    -0.001066585115965711,
    -0.00052700717973065,
    -0.001066585115965711,
    0.0026355722379033317,
    0.00364582452324122,
    0.0036953296865958676,
    0.005276421893855007,
    0.007906367452012342],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0020828281400432636,
    0.0010497862195559537,
    0.001574398038493588,
    0.0015501274474494856,
    -0.000552294311466188,
    0.0005076402251080678,
    0.0005076402251080678,
    0.0005076402251080678,
    0.003587051209783601,
    0.0026241408525121968,
    -0.003732120334417114,
    -0.014218351783347745]],
    [[0.0,
    -0.0005301369416265758,
    -0.0005022136508815375,
    0.0,
    -0.0009852688661078357,
    -0.002955627888850995,
    -0.0005022136508815375,
    -0.00048784459775214756,
    0.000989825859217336,
    0.002453919605327086,
    0.0024674963162833255,
    0.002453919605327086,
    0.004380028516108032],
    [0.0,
    0.0015420999260923746,
    -3.5947783127779354e-05,
    0.0015420999260923746,
    0.0005199294161473272,
    -0.0005139434774248317,
    0.0015420999260923746,
    0.0025702404313442118,
    0.0010281549319558075,
    0.0015420999260923746,
    0.005129704539847298,
    0.004015608732323414,
    0.005638291784149992],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0014511499698540986,
    -0.0010169974329463163,
    -0.00202725771756972,
    -0.0004758522737277303,
    -0.002902341338901177,
    -0.0014511499698540986,
    0.0009521754692673155,
    0.0009521754692673155,
    0.0014280314029536632,
    -0.0025176805150064555,
    -0.0034038406493024156,
    -0.01112742393557704]],
    [[0.0,
    -0.0009445859699703588,
    -0.0004442513941247603,
    0.00043494972677950855,
    0.002351860707588131,
    0.0,
    0.002843265754582519,
    0.0014392105171576741,
    0.00474217793101292,
    0.0042483816853327305,
    0.006622515885856252,
    0.005641964841445385,
    0.009453945436333218],
    [0.0,
    -0.0009646949412483799,
    -0.00048525053606011254,
    -0.0004700866338772994,
    0.0,
    0.0014681044567962445,
    -0.0009646949412483799,
    0.0009134373828625295,
    0.0004592813497567849,
    0.0019158059319733176,
    0.0029081857050566526,
    0.0038771011189359314,
    0.0038909633492296633],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.001382473990975637,
    2.06745689724612e-05,
    -0.0004692095859063529,
    0.0018396346284184906,
    -0.001382473990975637,
    -0.0004692095859063529,
    -0.0005363670766179787,
    0.0018396346284184906,
    0.003281790546375965,
    0.0,
    -0.004212719161992472,
    -0.01448094404058077]],
    [[0.0,
    0.00046740620284044243,
    0.0009814406480234336,
    -0.0005187089170694895,
    0.003440588812301096,
    -0.0010331561948239143,
    -0.0005187089170694895,
    0.0014590359172528891,
    0.003994602620058921,
    0.005481731633316535,
    0.007485750153955181,
    0.00699408895643204,
    0.006968844270888161],
    [0.0,
    -0.0009749873675270332,
    -3.2028916716074496e-05,
    -0.0004903161848047247,
    -0.0019118419095870906,
    -0.0014380823428828127,
    -0.0009588048625167739,
    0.0004636249747131532,
    0.0023548642474288325,
    0.002876129702658846,
    0.0009481214213668474,
    0.0042991785511773475,
    0.004764055331598301],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.000547012225923231,
    0.0025793204999531166,
    0.0005779129143762447,
    0.000547012225923231,
    0.00154475980731663,
    0.001512642908744477,
    0.000547012225923231,
    0.0025231881146431587,
    6.455975455477853e-05,
    -0.0010624661998250746,
    -0.0029875896483875473,
    -0.009978786596067454]],
    [[0.0,
    -0.0004672426641706487,
    0.0004576923813383871,
    -0.0019817283118442747,
    -0.0009445499621034692,
    -0.002896528418831916,
    -4.5844676426293196e-05,
    -0.0014324820528277618,
    0.0009971301433381805,
    3.155205661283661e-05,
    0.0010127306088167434,
    0.0038817419221674823,
    0.0034475236331570555],
    [0.0,
    0.0005197014320233659,
    -0.0005354879340232904,
    -0.00017285017866686125,
    0.0005197014320233659,
    -0.0010628446711044431,
    0.0015821936807265888,
    -0.0005588063785149436,
    -0.001606985500347033,
    -0.0010880187504145322,
    -2.3677986432012188e-05,
    -0.0005354879340232904,
    0.00155953368846809],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.002300201756910692,
    -0.000725198745438943,
    -0.0017017798490122742,
    -0.0005959927700538402,
    -0.0005959927700538402,
    -0.0034037395521761132,
    0.0,
    0.0,
    0.0021906268733054915,
    0.0,
    -0.0034037395521761132,
    -0.013819435826920546]]])

    crosstalks_data.append([[[0.0,
    -0.0017962177546849145,
    0.0018477946082881141,
    -0.0008867180669529101,
    -0.0008497708930634562,
    -0.0008867180669529101,
    -0.0008497708930634562,
    0.0010058508739985428,
    0.0028380859013905357,
    0.0018477946082881141,
    -0.0008867180669529101,
    0.0,
    -0.0036898203178039185],
    [0.0,
    -0.0019167658997734302,
    -0.0009534207321622926,
    0.0024431126010543147,
    0.0032084388195013913,
    0.0008000775889776407,
    -0.002523590004630351,
    0.0008408671105766333,
    0.0008408671105766333,
    0.0016960213311492736,
    0.004179330297439103,
    0.0016545387578487183,
    0.004179330297439103],
    [0.0,
    0.0007811839747620605,
    0.0032494223877737385,
    0.0007811839747620605,
    -0.00026215488254647396,
    0.002427001414053241,
    0.00126618343786504,
    0.002427001414053241,
    0.004045244486201853,
    0.007280802722502207,
    0.008898920789632114,
    0.004775354592966546,
    0.009673376231193846],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    0.0014495927279069634,
    -0.0014145926113693502,
    -0.0014145926113693502,
    0.0,
    -0.002148924661966242,
    -0.001467773211646227,
    -0.0014421820282108297,
    -0.0028469267424593506,
    0.0007336519954744825,
    0.0007336519954744825,
    -0.0028469267424593506,
    -0.005711158976135236],
    [0.0,
    -0.002582416322503868,
    0.0025261500722021588,
    -0.0013059084071104718,
    -0.001936896863782414,
    -0.0012838589908893971,
    -0.003920600587891794,
    -0.005202828303205127,
    -0.007213382721595531,
    -0.005251943702977338,
    -0.008460019880401647,
    -0.006525672782009856,
    -0.006525672782009856],
    [0.0,
    -0.0024977108720334873,
    0.002034862245553236,
    -0.0011974039696806826,
    -0.0018378305897427116,
    0.0026756900327096905,
    0.0012368980100582738,
    0.0014025951268514178,
    0.000639245197242233,
    0.0013761948595054016,
    0.005936366814394585,
    0.003985654905123183,
    0.008552963656474316],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    -0.001237867598540568,
    0.0006009347406974591,
    -1.7700028361856968e-05,
    0.0011906213334008098,
    0.0,
    -0.0006127351314295787,
    0.0011906213334008098,
    0.0011906213334008098,
    0.001207655500552851,
    0.0,
    -0.001856676615797137,
    -0.004289644304031608],
    [0.0,
    -0.0011788153661301051,
    -0.0005747608960070677,
    0.0,
    -0.0017033827883227506,
    0.0017396630334452975,
    -0.0005927056694937996,
    -1.9358597407655165e-05,
    0.001722072700897151,
    -1.9358597407655165e-05,
    0.002319463853425109,
    0.003461167359564671,
    0.005182660765348554],
    [0.0,
    -0.0011556792817606631,
    -0.0022504178463138153,
    -0.0016972160812890671,
    -0.0016785376737838698,
    -0.0016785376737838698,
    -0.0028708285846278936,
    -1.8074866202706652e-05,
    -1.8074866202706652e-05,
    0.0005594287519574623,
    -0.0011899575179169022,
    0.0004907580185257096,
    0.0016785261084362735],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    0.0026626606036668846,
    0.0,
    0.0026626606036668846,
    0.0026312767634323816,
    0.0015648899299816402,
    0.0015975578971840973,
    0.0031951056602849345,
    0.0021194427028618235,
    0.0037172965966653787,
    0.005857727254438297,
    0.0015648899299816402,
    0.0010651139105631313],
    [0.0,
    1.799672546037856e-05,
    0.0020843237767826095,
    -0.0005338966199662995,
    1.799672546037856e-05,
    -0.0015660713591592323,
    -0.0004970126193695745,
    0.001048303340686417,
    0.0,
    0.0015633143724301524,
    0.0009610702761149864,
    0.006135966909825034,
    0.005667530750847166],
    [0.0,
    0.00047921335143080723,
    -0.0005275453946956832,
    0.0009472622835072012,
    0.0009094473504369788,
    0.002455916760067664,
    0.0014563417587717953,
    0.003896570953964007,
    0.004404422109631247,
    0.005893921514890647,
    0.005861820644250761,
    0.007367370486914972,
    0.011787659392224113],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    -0.0024070044632472087,
    0.00048133093672916155,
    -0.0004905122233268694,
    -0.002420908580635539,
    -0.0004905122233268694,
    -0.0015009200876480028,
    0.0009538985209211204,
    -0.0009628329298089489,
    -0.0019349449271512456,
    -0.0004768683827459305,
    -0.0029029411582446596,
    -0.004823884384552543],
    [0.0,
    -0.000999654494350799,
    1.64040636961571e-05,
    -0.000982499004785524,
    -0.000999654494350799,
    -0.0020275631443209957,
    -0.000999654494350799,
    -0.0024893004388995693,
    -4.9283905849947796e-05,
    -0.001992838078121499,
    -0.0010328318336947223,
    -1.7537415124543876e-05,
    0.0010211412338005654],
    [0.0,
    0.00048189960546290295,
    -0.001423142278675571,
    0.0009686119412973121,
    0.0004999596084260954,
    0.0009686119412973121,
    0.002411442248169103,
    0.003384727332315013,
    0.005709984509436057,
    0.004793465292916542,
    0.00819770328464696,
    0.006739666998566478,
    0.012038710868910792],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    -0.0004923774571706022,
    0.00047291444167425756,
    0.001833561578443256,
    0.0009378708465329483,
    0.00185627356589467,
    0.0009264239031686813,
    -0.00045713172439786065,
    0.002309965403283286,
    0.001833561578443256,
    0.003693493778942243,
    0.0009264239031686813,
    -0.00045713172439786065],
    [0.0,
    -0.0010008827014423016,
    0.0004783084129646384,
    -0.0004882888732281043,
    -0.002872182532222732,
    0.0,
    -0.0019237374832550766,
    -0.0004882888732281043,
    0.0009471312364473586,
    0.0,
    -0.00047347014360012846,
    0.0009192234908141986,
    0.0028279033285315766],
    [0.0,
    -0.0013774738034996181,
    -0.0013774738034996181,
    0.00042453420227414607,
    0.0,
    0.0009070390937498604,
    0.0009070390937498604,
    0.0018365203194111793,
    0.0013445807686753158,
    0.0032139655727269067,
    0.004560374565467068,
    0.003632370765405145,
    0.005954299117903836],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    0.0005028716699407992,
    -1.3579928425606902e-05,
    1.4387879998828401e-05,
    -0.0009627635512729216,
    0.0019684991103067206,
    0.0,
    0.0004180667540490124,
    0.002461554983369127,
    0.0019410556770888474,
    0.005392547429959739,
    0.003434119405415853,
    0.0009822121410000481],
    [0.0,
    -0.0004692499590164684,
    0.00047346796109082323,
    0.00047346796109082323,
    -0.0009322268076825957,
    1.5297593337418314e-05,
    1.5297593337418314e-05,
    -0.0009162284728959011,
    -0.00045307158185436264,
    1.5297593337418314e-05,
    0.004648086442530362,
    0.00047346796109082323,
    0.002811601449105576],
    [0.0,
    0.0009108031528212851,
    0.0013489435611129807,
    -0.0004742508011277777,
    -0.0009044029189748462,
    0.00046140601141262533,
    -0.0009231575921257659,
    -0.00045524219647537223,
    0.0022065554573267934,
    0.0004433937501557156,
    0.0,
    0.001366047437095702,
    0.0036428428941506982],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
    [[0.0,
    -0.0009249003076746004,
    -0.004734653544908533,
    -0.0019775818226114086,
    -0.005217031143365511,
    -0.004263134534488212,
    -0.0033198666767598264,
    -0.002863259754113716,
    -0.00044304578997129973,
    -0.0009550825905112192,
    -0.0014017281343829333,
    -0.0037863091341336502,
    -0.002863259754113716],
    [0.0,
    -0.001031137973129051,
    -0.0015464940586202777,
    -0.0005303312740720448,
    0.0,
    -0.0015464940586202777,
    -0.001031137973129051,
    -0.0015464940586202777,
    -0.001569974067810162,
    -0.0010767719432754272,
    -0.0015464940586202777,
    -0.0025776643822778486,
    0.0005153591123728679],
    [0.0,
    5.558052550257153e-05,
    0.0005013478853638856,
    -0.0004885848221637401,
    -0.001051898328415471,
    -0.000517304198275434,
    -0.001051898328415471,
    0.002216059818722242,
    -0.0005432367606788766,
    0.003225284882370852,
    0.003321727901205475,
    0.004931702679733557,
    0.0076328377508032424],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]])

#####
    ### 0823 weights_data
#####
elif WEIGHTS_DATA_VERSION == '0823':
    weights_data = [[0.05786018097341549,
    0.05788121935154555,
    0.05847013960916469,
    0.06172690256370914,
    0.07846491938999092,
    0.09202457702745447,
    0.153849880993544,
    0.19508662837424037,
    0.2923466362318564,
    0.38059321122355705,
    0.4856022296720746,
    0.5661276874294634,
    0.6472928350955426,
    0.7445608910673891,
    0.7999618200114683,
    0.8456974816957387,
    0.893366094863922,
    0.9229971739647663,
    0.9552071104614438,
    0.9771069431923493,
    0.9970772717309229],
  [0.04404945817609938,
    0.04145943931851121,
    0.04788886529061932,
    0.05621455982212963,
    0.0760257990474354,
    0.12585806217178166,
    0.16881247925800325,
    0.2654069459295709,
    0.3537098042651145,
    0.4855025536607113,
    0.5744299468701627,
    0.6723157917090337,
    0.7567662601337116,
    0.820744857681807,
    0.8636097892109214,
    0.9058349439380275,
    0.935263721010991,
    0.9582930752547277,
    0.9781295231455782,
    0.9890048704097841,
    0.9998806465258588],
  [0.0367666889148761,
    0.03563234171976763,
    0.03565858772540307,
    0.04679902429508959,
    0.0803213190060225,
    0.12994353291245467,
    0.24724669803876484,
    0.3622807427475751,
    0.49907425675153605,
    0.5878365957820448,
    0.7006317213321722,
    0.7464134321895719,
    0.8206742490033659,
    0.8809742281974672,
    0.902189849166146,
    0.9222898637919152,
    0.9021888151329195,
    0.9161492145657002,
    0.9524408664391677,
    0.9574658642807501,
    0.9418318754985562],
  [0.020691772674178738,
    0.02180662195192488,
    0.02907359362169949,
    0.048817352901329124,
    0.0791623672560917,
    0.16923506807132876,
    0.2665325592668014,
    0.39537029048109124,
    0.49886228479265493,
    0.6085600595460944,
    0.6732490848100758,
    0.7480611892757729,
    0.8133159338968579,
    0.8611286974699035,
    0.8892550184121654,
    0.8948794285415947,
    0.9303176929840541,
    0.9410060955929659,
    0.9286301566504733,
    0.9432561421016746,
    0.9646296195806102]]
    
    crosstalks_data = [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0012521104381534379,
    -0.0012791995610521231,
    -0.0031718663875344028,
    0.0012900151761919693,
    -0.0031718663875344028,
    -0.0012521104381534379,
    -0.0006304420112083556,
    -0.0025510010642888284,
    -0.0025222778228412915,
    -0.0018918395144360903,
    -0.005731383876443709,
    -0.005091664007178177,
    -0.0044716763775576665,
    -0.00707684942767875,
    -0.007651223819852462,
    -0.00896402513658523,
    -0.012771420714177847,
    -0.014691555478195367,
    -0.023796019977542014,
    -0.034547570350301995],
    [0.0,
    -0.0022846089311812437,
    -0.00335078731116234,
    -0.0034050342190234603,
    -0.0034050342190234603,
    0.0005425314790664243,
    -0.005026241047234523,
    -0.0011335448641097562,
    -0.0028097226678221454,
    -0.003937059264723375,
    -0.00335078731116234,
    -0.0028097226678221454,
    -0.00445847529963235,
    -0.005053322587227925,
    -0.0028097226678221454,
    -0.004486016980040183,
    -0.0005582930496614916,
    -0.005640590615358841,
    -0.0028097226678221454,
    -0.0039090723258386195,
    -0.0039090723258386195],
    [0.0,
    0.0005772426801858126,
    0.0005348325494731326,
    0.0005348325494731326,
    0.0,
    -0.0007520041801870742,
    -8.955925803953366e-05,
    -0.001156167736769003,
    -0.0011102917297324995,
    0.001605678944617158,
    0.001126205997525439,
    -0.001688791005337139,
    -8.955925803953366e-05,
    0.0005348325494731326,
    -0.0006094720715678521,
    0.00044308090142309436,
    0.0005348325494731326,
    -0.001156167736769003,
    -0.0005623839782312144,
    -0.0012409876224591838,
    -0.001256087985074466]],
  [[0.0,
    0.0038669981231987324,
    0.0025788808769245525,
    0.0012968138451752431,
    0.001955783436118262,
    0.0012542635708410535,
    0.0025999192550546085,
    0.001955783436118262,
    0.0038885048700280783,
    0.005780864224625773,
    0.0032300289221229295,
    0.0025788808769245525,
    0.0038669981231987324,
    0.0006671797399165763,
    0.001955783436118262,
    0.0012968138451752431,
    0.0032300289221229295,
    0.004490536015441818,
    0.005821211648354682,
    0.006386281687434971,
    0.004512269485135431],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    -0.0011664833479712033,
    -0.0050541066419582115,
    -0.0033507121586046074,
    -0.002792422849948517,
    -0.00560306435727502,
    -0.0022255254018676146,
    -0.003900524039421545,
    -0.0005745158981684123,
    -0.00560306435727502,
    -0.0033507121586046074,
    -0.006757637992593678,
    -0.004522081596258297,
    -0.007334576678609046,
    -0.003926770045056982,
    -0.002250592241344593,
    -0.005026119703073456,
    -0.0044678346883971765,
    -0.00892551995143417,
    -0.010632849292262731,
    -0.010632849292262731],
    [0.0,
    0.002282373734294442,
    0.002806285816086499,
    0.0016910002862421357,
    0.0005937837585377886,
    0.0028447755472111,
    0.002238925413349347,
    0.0005065298295533552,
    0.001156167736769003,
    0.0016910002862421357,
    0.0005065298295533552,
    0.0005937837585377886,
    0.003420944826981527,
    0.0028447755472111,
    0.0005937837585377886,
    0.0005937837585377886,
    0.002761846681386161,
    0.0005937837585377886,
    0.0039708213620695924,
    0.0005065298295533552,
    0.001156167736769003]],
  [[0.0,
    0.0012820670317493094,
    0.0013031054098793654,
    0.0032358285624797672,
    -0.0006296341052586668,
    2.200208943133053e-05,
    0.0019332150769476864,
    -0.001318303273004938,
    0.000658969590943019,
    0.000658969590943019,
    0.0019332150769476864,
    -0.0006296341052586668,
    -4.255027433418962e-05,
    0.000658969590943019,
    0.0012820670317493094,
    2.200208943133053e-05,
    2.200208943133053e-05,
    0.000658969590943019,
    -0.0006296341052586668,
    -0.0019804985768245922,
    -0.0019332665339400618],
    [0.0,
    0.0006304383084052012,
    -0.0012893133542845533,
    0.0006304383084052012,
    0.0006304383084052012,
    0.0012701673846878536,
    0.0031898869336264013,
    -2.8723241447536907e-05,
    -0.0006495885646931113,
    -0.0012893133542845533,
    0.0,
    0.0005746139885712404,
    -0.0007088638125663863,
    0.0,
    0.004469838353804517,
    0.0012430782617891684,
    0.0024966667336171616,
    0.0012430782617891684,
    0.0005746139885712404,
    -8.887202851014936e-05,
    0.0012701673846878536],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0.0,
    0.0012054716934958506,
    0.0007326469733041699,
    0.0007326469733041699,
    0.0012054716934958506,
    0.00013886321476638125,
    -0.0010507540469552185,
    0.001829863501008517,
    -0.0010075155563233525,
    -0.0020827855547873968,
    0.00013886321476638125,
    -0.0015027951880070313,
    -0.0015027951880070313,
    -0.003772117992326133,
    -0.004938657999568776,
    -0.006024104359281928,
    -0.012791834110723283,
    -0.017658162162668696,
    -0.01791926131428737,
    -0.01003067951988105,
    -0.006633595015548888]],
  [[0.0,
    0.001977793470304745,
    0.003910516622905147,
    0.003266379085278215,
    0.0006746880604253797,
    0.001934263179338494,
    0.001934263179338494,
    0.005843224960263703,
    4.5053955166712845e-05,
    0.0006966901498567102,
    -0.0005990799628494969,
    -0.0006221257847498635,
    -0.0006221257847498635,
    -0.003191902131036893,
    -0.001258578473514682,
    -0.005753281847614228,
    -0.013484770608783503,
    -0.01992791301031984,
    -0.040557517985499905,
    -0.05148048925251247,
    -0.038688866519853954],
    [0.0,
    -0.0013366337179894008,
    -2.7876277131085037e-05,
    0.0012884941938967748,
    -2.7876277131085037e-05,
    -0.0025501540999723765,
    -0.001975540111401136,
    -0.001279986715284523,
    -0.0025501540999723765,
    -0.001975540111401136,
    -0.0019197157915671753,
    -0.003199742664665488,
    -0.0025788773414199134,
    -2.7876277131085037e-05,
    -2.7876277131085037e-05,
    -5.3487366355214894e-05,
    0.0,
    -0.0006583182883394406,
    -0.00383946745425693,
    -0.002639026128482526,
    -0.0025788773414199134],
    [0.0,
    0.0005668974480809025,
    0.0,
    0.0,
    0.001117082423052189,
    -0.0027830998269186696,
    -0.0022870807192767115,
    -0.00402732172588878,
    0.0005668974480809025,
    -0.0022870807192767115,
    -0.0016754118384486594,
    0.0,
    -0.001134347195108465,
    -0.0005582893086560903,
    0.0,
    -0.002233696853124939,
    -0.001134347195108465,
    -0.0016754118384486594,
    -0.005026367922239185,
    -0.0011844808484720235,
    -0.001134347195108465],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]

class FSR_MRR_Config_Simu:
    def __init__(self, mrr_config_type, device):
        ### Single FSR
        if mrr_config_type == 'single-posneg':
            self.v_min = -1.0
            self.v_max = 1.0
            self.fsr_channels = 1
            self.mrr_in = 4
            self.mrr_out = 1
            self.pos_and_neg = True
        elif mrr_config_type == 'single-pos':
            self.v_min = 0
            self.v_max = 1.0
            self.fsr_channels = 1
            self.mrr_in = 4
            self.mrr_out = 1
            self.pos_and_neg = False
        
        ### Multi-FSR
        elif mrr_config_type == 'multi-posneg':
            self.v_min = -0.76
            self.v_max = 0.76
            self.fsr_channels = 8
            self.mrr_in = 4
            self.mrr_out = 1
            self.pos_and_neg = True
        elif mrr_config_type == 'multi-pos':
            self.v_min = 0
            self.v_max = 0.76
            self.fsr_channels = 8
            self.mrr_in = 4
            self.mrr_out = 1
            self.pos_and_neg = False
        
        self.device = device
        
        self.weights_data = torch.tensor(weights_data)
        self.crosstalks_data = torch.tensor(crosstalks_data)
        # self.weights_data = torch.tensor(weights_data).to(self.device)
        # self.crosstalks_data = torch.tensor(crosstalks_data).to(self.device)
        
    def Four_MRR_array(self, V: torch.Tensor = torch.tensor([0,0,0,0])):
        V = V.squeeze().cpu()
        # V = V.squeeze()
        assert len(V) == 4
        
        weights_data = self.weights_data
        crosstalks_data = self.crosstalks_data
    
        weights = []
        weights = torch.zeros((4,8), device=self.device)
        for i in range(4):
            for j in range(8):
                if V[i] >= 1.2:
                    w = weights_data[i][j][12]
                elif V[i]<= 0.0:
                    w = weights_data[i][j][0]
                else:
                    a = int(10*V[i])
                    w = weights_data[i][j][a]+(weights_data[i][j][a+1]-weights_data[i][j][a])*(10*V[i]-a)
                weights[i,j] = w

        crosstalks = torch.zeros((4,8), device=self.device)
        for i in range(4):
            tt = torch.zeros((4,8), device=self.device)
            for k in range(4):
                for j in range(8):
                    if V[i] >= 1.2:
                        c = crosstalks_data[i][j][k][12]
                    elif V[i] <= 0.0:
                        c = crosstalks_data[i][j][k][0]
                    else:
                        a = int(10*V[i])
                        c = crosstalks_data[i][j][k][a]+(crosstalks_data[i][j][k][a+1]-crosstalks_data[i][j][k][a])*(10*V[i]-a)
                    tt[k,j] = c
            crosstalks = crosstalks+tt
        
        # return shape [4,8] -> [8,4] -> [8,1,4]
        return (weights+crosstalks).transpose(1,0).reshape(self.fsr_channels, self.mrr_out, self.mrr_in).to(self.device)
      
    def One_MRR_array(self, V: torch.Tensor = torch.tensor([0,0,0,0])):
        if WEIGHTS_DATA_VERSION == '0731':
            V = V.squeeze().cpu()
            # V = V.squeeze()
            assert len(V) == 4
            weights_data = self.weights_data
            crosstalks_data = self.crosstalks_data
            j = 7
            
            weights = torch.zeros((4,), device=self.device)
            for i in range(4):
                if V[i] >= 1.2:
                    w = weights_data[i][j][12]
                elif V[i]<= 0.0:
                    w = weights_data[i][j][0]
                else:
                    a = int(10*V[i])
                    w = weights_data[i][j][a]+(weights_data[i][j][a+1]-weights_data[i][j][a])*(10*V[i]-a)
                
                weights[i] = w

            crosstalks = torch.zeros((4,), device=self.device)
            for i in range(4):
                tt = torch.zeros((4,), device=self.device)
                for k in range(4):
                    if V[i] >= 1.2:
                        c = crosstalks_data[i][j][k][12]
                    elif V[i] <= 0.0:
                        c = crosstalks_data[i][j][k][0]
                    else:
                        a = int(10*V[i])
                        c = crosstalks_data[i][j][k][a]+(crosstalks_data[i][j][k][a+1]-crosstalks_data[i][j][k][a])*(10*V[i]-a)
                    tt[k] = c
                crosstalks = crosstalks+tt
            
            # return shape [1,4]
            return (weights+crosstalks).unsqueeze(0).to(self.device)
        elif WEIGHTS_DATA_VERSION == '0823':
            V = V.squeeze().cpu()
            # V = V.squeeze()
            assert len(V) == 4
            weights_data = self.weights_data
            crosstalks_data = self.crosstalks_data
            
            weights = torch.zeros((4,), device=self.device)
            for i in range(4):
                if V[i] >= 1.0:
                    w = weights_data[i][20]
                elif V[i]<= 0.0:
                    w = weights_data[i][0]
                else:
                    a = int(20*V[i])
                    w = weights_data[i][a]+(weights_data[i][a+1]-weights_data[i][a])*(20*V[i]-a)
                weights[i] = w
                
            crosstalks = torch.zeros((4,), device=self.device)
            for i in range(4):
                tt = torch.zeros((4,), device=self.device)
                for j in range(4):
                    if V[i] >= 1.0:
                        c = crosstalks_data[i][j][20]
                    elif V[i] <= 0.0:
                        c = crosstalks_data[i][j][0]
                    else:
                        a = int(20*V[i])
                        c = crosstalks_data[i][j][a]+(crosstalks_data[i][j][a+1]-crosstalks_data[i][j][a])*(20*V[i]-a)
                    tt[k] = c
                crosstalks = crosstalks+tt
            
            # return shape [1,4]
            return (weights+crosstalks).unsqueeze(0).to(self.device)
        elif WEIGHTS_DATA_VERSION == 'LAB_DATA':
            raise NotImplementedError
            
# class FSR_MRR_Config:
#     v_min = 0
#     v_max = 1.2
#     fsr_channels = 1
#     mrr_in = 4
#     mrr_out = 1
#     pos_and_neg = True


